{"ast":null,"code":"import { NgZone, Injector } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { NotificationService } from '../services/notification.service';\nimport { VehicleService } from '../services/vehicle.service';\nimport 'rxjs/add/observable/forkJoin';\nimport { Observable } from 'rxjs';\nimport * as _ from 'underscore';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../services/vehicle.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\n\nfunction VehicleFormComponent_option_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 27);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const m_r14 = ctx.$implicit;\n    i0.ɵɵpropertyInterpolate(\"value\", m_r14.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(m_r14.name);\n  }\n}\n\nfunction VehicleFormComponent_div_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 28);\n    i0.ɵɵtext(1, \"Please specify the Make.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction VehicleFormComponent_option_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 27);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const m_r15 = ctx.$implicit;\n    i0.ɵɵpropertyInterpolate(\"value\", m_r15.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(m_r15.name);\n  }\n}\n\nfunction VehicleFormComponent_div_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 28);\n    i0.ɵɵtext(1, \"Please specify the Model.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction VehicleFormComponent_div_33_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r18 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 29)(1, \"label\", 30)(2, \"input\", 31);\n    i0.ɵɵlistener(\"change\", function VehicleFormComponent_div_33_Template_input_change_2_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r18);\n      const f_r16 = restoredCtx.$implicit;\n      const ctx_r17 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r17.onFeatureToggle(f_r16.id, $event));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const f_r16 = ctx.$implicit;\n    const ctx_r7 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate1(\"for\", \"feature\", f_r16.id, \"\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate1(\"id\", \"feature\", f_r16.id, \"\");\n    i0.ɵɵproperty(\"checked\", ctx_r7.vehicle.features.includes(f_r16.id));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", f_r16.name, \" \");\n  }\n}\n\nfunction VehicleFormComponent_div_41_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 28);\n    i0.ɵɵtext(1, \"Please specify the Name.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction VehicleFormComponent_div_47_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 28);\n    i0.ɵɵtext(1, \"Please specify the Phone.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction VehicleFormComponent_div_53_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 28);\n    i0.ɵɵtext(1, \"Please specify the Email.\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nexport let VehicleFormComponent = /*#__PURE__*/(() => {\n  class VehicleFormComponent {\n    constructor(route, router, injector, vehicleService, ngZone) {\n      this.route = route;\n      this.router = router;\n      this.injector = injector;\n      this.vehicleService = vehicleService;\n      this.ngZone = ngZone;\n      this.vehicle = {\n        id: 0,\n        makeId: 0,\n        modelId: 0,\n        isRegistered: false,\n        features: [],\n        contact: {\n          name: '',\n          email: '',\n          phone: ''\n        }\n      };\n      route.params.subscribe(p => {\n        this.vehicle.id = +p['id'];\n      });\n    }\n\n    ngOnInit() {\n      var sources = [this.vehicleService.getMakes(), this.vehicleService.getFeatures()];\n\n      if (this.vehicle.id) {\n        sources.push(this.vehicleService.getVehicle(this.vehicle.id));\n      }\n\n      Observable.forkJoin(sources).subscribe(data => {\n        this.makes = data[0];\n        this.features = data[1];\n\n        if (this.vehicle.id) {\n          this.setVehicle(data[2]);\n          this.populateModels();\n        }\n      }, err => {\n        if (err.status == 404) {\n          this.router.navigate(['']);\n        }\n      });\n    }\n\n    setVehicle(v) {\n      this.vehicle.id = v.id;\n      this.vehicle.makeId = v.make.id;\n      this.vehicle.modelId = v.model.id;\n      this.vehicle.isRegistered = v.isRegistered;\n      this.vehicle.contact = v.contact;\n      this.vehicle.features = _.pluck(v.features, 'id');\n    }\n\n    get toastrService() {\n      return this.injector.get(NotificationService);\n    }\n\n    onMakeChange() {\n      this.populateModels();\n      delete this.vehicle.modelId;\n    }\n\n    populateModels() {\n      var selectedMake = this.makes.find(m => m.id == this.vehicle.makeId);\n      this.models = selectedMake ? selectedMake.models : [];\n    }\n\n    onFeatureToggle(featureId, $event) {\n      if ($event.target.checked) {\n        this.vehicle.features.push(featureId);\n      } else {\n        var index = this.vehicle.features.indexOf(featureId);\n        this.vehicle.features.splice(index, 1);\n      }\n    }\n\n    submit() {\n      var IsRegistered = this.vehicle.isRegistered == true;\n      this.vehicle.isRegistered = IsRegistered;\n      this.vehicleService.create(this.vehicle).subscribe(data => {\n        console.log(data);\n        this.ShowSuccess();\n      }, error => {\n        this.ShowError();\n      });\n    }\n\n    ShowError() {\n      console.log(\"HERE\");\n      this.ngZone.run(() => {\n        this.toastrService.showError(\"ERROR\", \"Error\");\n        console.log(\"HERE1\");\n      });\n    }\n\n    ShowSuccess() {\n      this.ngZone.run(() => {\n        this.toastrService.showSuccess(\"SUCCESS\", \"Success\");\n      });\n    }\n\n  }\n\n  VehicleFormComponent.ɵfac = function VehicleFormComponent_Factory(t) {\n    return new (t || VehicleFormComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(Injector), i0.ɵɵdirectiveInject(i2.VehicleService), i0.ɵɵdirectiveInject(i0.NgZone));\n  };\n\n  VehicleFormComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: VehicleFormComponent,\n    selectors: [[\"app-vehicle-form\"]],\n    decls: 56,\n    vars: 20,\n    consts: [[3, \"ngSubmit\"], [\"f\", \"ngForm\"], [1, \"form-group\"], [\"for\", \"make\"], [\"id\", \"make\", \"name\", \"makeId\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"change\", \"ngModelChange\"], [\"make\", \"ngModel\"], [\"value\", \"\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"alert alert-danger\", 4, \"ngIf\"], [\"for\", \"model\"], [\"id\", \"model\", \"name\", \"modelId\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"model\", \"ngModel\"], [\"for\", \"registered\", 1, \"radio-inline\"], [\"name\", \"isRegistred\", \"type\", \"radio\", \"id\", \"registered\", 3, \"value\", \"ngModel\", \"ngModelChange\"], [\"for\", \"notRegistered\", 1, \"radio-inline\"], [\"name\", \"isRegistred\", \"type\", \"radio\", \"id\", \"notRegistered\", 3, \"value\", \"ngModel\", \"ngModelChange\"], [\"class\", \"checkbox\", 4, \"ngFor\", \"ngForOf\"], [\"for\", \"contactName\"], [\"id\", \"contactName\", \"type\", \"text\", \"name\", \"contactName\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"name\", \"ngModel\"], [\"for\", \"contactPhone\"], [\"id\", \"contactPhone\", \"type\", \"text\", \"name\", \"contactPhone\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"phone\", \"ngModel\"], [\"for\", \"contactEmail\"], [\"id\", \"contactEmail\", \"type\", \"text\", \"name\", \"contactEmail\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"email\", \"ngModel\"], [1, \"btn\", \"btn-primary\"], [3, \"value\"], [1, \"alert\", \"alert-danger\"], [1, \"checkbox\"], [3, \"for\"], [\"type\", \"checkbox\", 3, \"id\", \"checked\", \"change\"]],\n    template: function VehicleFormComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"h1\");\n        i0.ɵɵtext(1, \"New Vehicle\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(2, \"p\");\n        i0.ɵɵtext(3);\n        i0.ɵɵpipe(4, \"json\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(5, \"form\", 0, 1);\n        i0.ɵɵlistener(\"ngSubmit\", function VehicleFormComponent_Template_form_ngSubmit_5_listener() {\n          return ctx.submit();\n        });\n        i0.ɵɵelementStart(7, \"div\", 2)(8, \"label\", 3);\n        i0.ɵɵtext(9, \"Make\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"select\", 4, 5);\n        i0.ɵɵlistener(\"change\", function VehicleFormComponent_Template_select_change_10_listener() {\n          return ctx.onMakeChange();\n        })(\"ngModelChange\", function VehicleFormComponent_Template_select_ngModelChange_10_listener($event) {\n          return ctx.vehicle.makeId = $event;\n        });\n        i0.ɵɵelement(12, \"option\", 6);\n        i0.ɵɵtemplate(13, VehicleFormComponent_option_13_Template, 2, 2, \"option\", 7);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(14, VehicleFormComponent_div_14_Template, 2, 0, \"div\", 8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(15, \"div\", 2)(16, \"label\", 9);\n        i0.ɵɵtext(17, \"Model\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"select\", 10, 11);\n        i0.ɵɵlistener(\"ngModelChange\", function VehicleFormComponent_Template_select_ngModelChange_18_listener($event) {\n          return ctx.vehicle.modelId = $event;\n        });\n        i0.ɵɵelement(20, \"option\", 6);\n        i0.ɵɵtemplate(21, VehicleFormComponent_option_21_Template, 2, 2, \"option\", 7);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(22, VehicleFormComponent_div_22_Template, 2, 0, \"div\", 8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(23, \"p\");\n        i0.ɵɵtext(24, \"Is the vehicle registered?\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(25, \"label\", 12)(26, \"input\", 13);\n        i0.ɵɵlistener(\"ngModelChange\", function VehicleFormComponent_Template_input_ngModelChange_26_listener($event) {\n          return ctx.vehicle.isRegistered = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(27, \" Yes \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(28, \"label\", 14)(29, \"input\", 15);\n        i0.ɵɵlistener(\"ngModelChange\", function VehicleFormComponent_Template_input_ngModelChange_29_listener($event) {\n          return ctx.vehicle.isRegistered = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(30, \" No \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(31, \"h2\");\n        i0.ɵɵtext(32, \"Features\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(33, VehicleFormComponent_div_33_Template, 4, 4, \"div\", 16);\n        i0.ɵɵelementStart(34, \"h2\");\n        i0.ɵɵtext(35, \"Contact\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(36, \"div\", 2)(37, \"label\", 17);\n        i0.ɵɵtext(38, \"Name\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(39, \"input\", 18, 19);\n        i0.ɵɵlistener(\"ngModelChange\", function VehicleFormComponent_Template_input_ngModelChange_39_listener($event) {\n          return ctx.vehicle.contact.name = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(41, VehicleFormComponent_div_41_Template, 2, 0, \"div\", 8);\n        i0.ɵɵelementStart(42, \"div\", 2)(43, \"label\", 20);\n        i0.ɵɵtext(44, \"Phone\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(45, \"input\", 21, 22);\n        i0.ɵɵlistener(\"ngModelChange\", function VehicleFormComponent_Template_input_ngModelChange_45_listener($event) {\n          return ctx.vehicle.contact.phone = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(47, VehicleFormComponent_div_47_Template, 2, 0, \"div\", 8);\n        i0.ɵɵelementStart(48, \"div\", 2)(49, \"label\", 23);\n        i0.ɵɵtext(50, \"Email\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(51, \"input\", 24, 25);\n        i0.ɵɵlistener(\"ngModelChange\", function VehicleFormComponent_Template_input_ngModelChange_51_listener($event) {\n          return ctx.vehicle.contact.email = $event;\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(53, VehicleFormComponent_div_53_Template, 2, 0, \"div\", 8);\n        i0.ɵɵelementStart(54, \"button\", 26);\n        i0.ɵɵtext(55, \"Save\");\n        i0.ɵɵelementEnd()();\n      }\n\n      if (rf & 2) {\n        const _r1 = i0.ɵɵreference(11);\n\n        const _r4 = i0.ɵɵreference(19);\n\n        const _r8 = i0.ɵɵreference(40);\n\n        const _r10 = i0.ɵɵreference(46);\n\n        const _r12 = i0.ɵɵreference(52);\n\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(4, 18, ctx.vehicle), \"\\n\");\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"ngModel\", ctx.vehicle.makeId);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngForOf\", ctx.makes);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", _r1.touched && !_r1.valid);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.vehicle.modelId);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngForOf\", ctx.models);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", _r4.touched && !_r4.valid);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"value\", true)(\"ngModel\", ctx.vehicle.isRegistered);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"value\", false)(\"ngModel\", ctx.vehicle.isRegistered);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngForOf\", ctx.features);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngModel\", ctx.vehicle.contact.name);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", _r8.touched && !_r8.valid);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.vehicle.contact.phone);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", _r10.touched && !_r10.valid);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.vehicle.contact.email);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", _r12.touched && !_r12.valid);\n      }\n    },\n    dependencies: [i3.NgForOf, i3.NgIf, i4.ɵNgNoValidate, i4.NgSelectOption, i4.ɵNgSelectMultipleOption, i4.DefaultValueAccessor, i4.SelectControlValueAccessor, i4.RadioControlValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i4.RequiredValidator, i4.NgModel, i4.NgForm, i3.JsonPipe],\n    styles: [\".radio-inline[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:10px}\"]\n  });\n  VehicleFormComponent.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: VehicleFormComponent,\n    factory: VehicleFormComponent.ɵfac\n  });\n  return VehicleFormComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}